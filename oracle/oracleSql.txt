Curso udemy SQL Oracle

1.- INTRODUCCION
	Data Manipulation Language (DML)
	SELECT
	INSERT
	UPDATE
	DELETE
	MERGE

	Data Definition Language (DDL)
	CREATE
	ALTER
	DROP
	RENAME
	TRUNCATE
	COMMENT

	Data control Language (DCL)
	GRANT
	REVOKE

	Transaction Control
	COMMIT
	ROLLBACK
	SAVEPOINT

	- Usuario HR para practica ya instalado.(Human Resource)

2.- Live SQL Oracle:
	https://livesql.oracle.com/
	Esquema: es la base de datos del usuario y todos los objetos que le pertenecen al usuario.
	-> select * from HR.EMPLOYEES
	
	Por que se presentan varias versiones para instalar en el curso?
		because you could face issues with 12c enterprise edition with windows
		but 18c express edition and 11g  express edition will work 100%
		
	Descargar 12c
	
3.- CONECTANDO A LA BASE DE DATOS (se usa root una vez solo para crear el primer usuario)
	ejecutar> SQL Plus 
	 super user: sys as sysdba
		pass:    el que instalamos
		
	> show con_name
	
	> c:\app\user\product\12.2.0\dbhome_!\network\admin\tnsnames.ora  <- archivo de config de la base de datos
	   ORCL: nombre de la conexion (Contenedor de la base de datos)
	> Abrir SQL Developer
		  User: sys as sysdba
	      Connection type: TNS
		  Network Alias: ORCL
	>Si no recuerda el pass sys: https://community.oracle.com/thread/899559 
	> Desbloqueo de usuario HR:
	     orcl: el contenedor general  (se conecta con sysdba)
		   orclpdb: el contenedor de base de prueba
		    
		> select name, con_id from v$pdbs   //para ver el diccionario info de la base de datos
		
	    > alter session set container=orclpdb  //Cambia el contenedor de la base de datos
		> show con_name
		> alter PLUGGABLE DATABASE open
		> select * from all_users; 
		> alter USER hr identified by hr account unlock;
		> pegar la conexion del pdf en el tns para hr
		> 
	> Crear un usuario
	  ORA-01033
	  ORA-65054
		sol:
			1- login as SYS as SYSdba
			2- make sure that you are in the root  CDB$ROOT
				you can know that by : show con_name
			3- do this
				alter system disable restricted session;
			4- then do this
				alter pluggable database all open;

4 y 5 ver .sql
	Para conectar con sql plus con hr:
		user: hr/hr@orclpdb
		
	 Formato fecha default
	 SELECT * FROM employees WHERE HIRE_DATE > '17-OCT-23'
	 select * from EMPLOYEES WHERE FIRST_NAME LIKE '_d%';  nombres que en su segunda letra tenga una 'd'
	 select * from EMPLOYEES WHERE FIRST_NAME LIKE '__d%';  nombres que en su tercera letra tenga una 'd'
	 select * from EMPLOYEES WHERE FIRST_NAME LIKE 'd_%';  incorrecto, revisar, no es lo mismo
	 select * from EMPLOYEES WHERE FIRST_NAME LIKE 'SA/_%';  Todos los nombres que tengan un guion bajo en tercer caracter
	 
	 select * from EMPLOYEES where COMISSIONS_PCT is null;  //=null es incorrecto es is null;
	 
	 Not equal
	   <> o !=  es lo mismo
	   
	 SELECT * FROM EMPLOYEES 
		WHERE (job_id = 'SA_REP' OR jb_id= 'AD_PRES')
		AND SALARY > 1500;
	 
	 SELECT * FROM EMPLOYEES WHERE job_id = 'SA_REP' ORDER BY COL1 ASC , COL2 DESC;		
	 SELECT COL1, COL2  FROM EMPLOYEES WHERE job_id = 'SA_REP' ORDER BY 1, 2 ; ordenar por nro de columna
	 
	 SELECT * FROM EMPLOYEES WHERE job_id = 'SA_REP' ORDER BY COL1 FETCH FIRST 10 ROWS ONLY
	 SELECT * FROM EMPLOYEES WHERE job_id = 'SA_REP' ORDER BY COL1 FETCH FIRST 50 PERCENT ROWS ONLY
	 
	 SELECT * FROM EMPLOYEES WHERE job_id = 'SA_REP' ORDER BY COL1  OFFSET 5  FETCH NEXT 5 ROWS ONLY //salta los primeros 5 registros y trae los siguientes 5
	 
	 TIES??
	 
Para que oracle pida una variable por ventana emergente
	 SELECT * FROM EMPLOYEES WHERE job_id = &JOB_ENTRADA
	 SELECT * FROM EMPLOYEES WHERE job_id = '&JOB_ENTRADA' //es lo mismo
	 
--Para scripts:
 DEFINE EMPLOYEE_NUM = 200;   
 select * from employees where EMPLOYEE_ID = &EMPLOYEE_NUM 
 UNDEFINE EMPLOYEE_NUM;	-- para eliminar la variable
 
 --ventanas emergentes
 ACCEPT DEPT_ID PROMPT 'please enter dept id'                --genera una ventana emergente con mensaje personalizado    
 SELECT * FROM EMPLOYEES WHERE DEPARTMENT_ID = &DEPT_ID;
 UNDEFINE DEPT_ID;
 
 -- doble ampersand
 select * from DEPARTMENTS where DEPARTMENT_ID=&&p  -- aparece solo una vez ventana emergente y memoriza hasta que termina la sesion
 
 -- VERIFICACION
 SET VERIFY ON   -- hace que en el output muestre la query antes de reemplazar la variable y luego muestra la query con el valore reemplazado
 SELECT * FROM EMPLOYEES WHERE DEPARTMENT_ID = &DEPT_ID;  
 
 -- NO VERIFICACION
 SET DEFINE OFF;       -- esto hace que no salte el prompt y queda como una cadena a buscar &DEPT_ID (Sirve para data migration)
 SELECT * FROM EMPLOYEES WHERE DEPARTMENT_ID = '&DEPT_ID';  
 
 SECCION 7
 -- funciones de caracteres 
		UPPER, 
		LOWER  
		INITCAP (Upper solo a la primira letra de la cadena)
 -- manipulacion de caracteres
		LENGTH(var)              --retorna el largo de la cadena
		CONCAT(var1,var2)
		SUBSTRING(FIRSTNANE,1,3) -- inicia en caracter 1 con largo de 3 caracteres
		SUBSTRING(FIRSTNANE,2)   -- hasta el final de la cadena
		SUBSTRING(FIRSTNANE,-3)  -- si es negativo corta la cadena contando desde el final
 -- INSTR
	Retorna la posición numerica de una cadena
	SELECT INSTR(FIRST_NAME,'e')  -- retorna la posición de la primera 'e' o subcadena
	SELECT INSTR(FIRST_NAME,'e', 2)  -- retorna la posición de la segunda 'e'
 -- LPAD
	LPAD(10,'#') -- rellena la salida con un largo de 10 y con signo # como relleno a la derecha
	RPAD(10,'#')
	REPLACE(FIRS_NAME,'a','*') -- reemplaza todos los caracteres a por un asterisco

 -- SELECT * FROM DUAL -- taba publica para mostrar datos
 -- LEADING, TRAILING, BOTH ?
 -- ROUND(10.5)  -- retorna 11
    ROUND(10.49, 1) -- solo toma el primer decimal y redondea, retorna 10.5
    TRUNC(10.65)    -- elimina los decimales
	TRUNC(10.65, 1) -- elimina el ultimo decimal
	MOD(10,5) =  0  -- retorna el modulo de la división.
    
 -- DATE FUNCTIONS defaul es DD-MON-RR 
   WHERE hire_date <  '1-FEB-23'
   -- date + number  -- suma días a la fecha
      date - number
   -- SELECT SYSDATE FROM DUAL -- SYSDATE es una funcion que retorna la fecha del servidor de base de datos
   -- MONTHS_BETWEEN(SYSDATE, HIREDATE) -- retorna los meses transcurridos entre las variables date   
   -- ADD_MONTHS(hiredate, 4)           -- suma 4 meses
   -- NEXT_DAY(SYSDATE,2)   -- 1 es domingo, 2 es lunes, retorna fecha del proximo lunes
   -- LAST_DAY(SYSDATE)     -- retorna la fecha del último día de la semana actual
   
   -- ROUND(SYSDATE, 'MONTH') --result 1-AUG-03  (asume sysdate = 25-JUL-03)
   
 -- Funciones anidadas
     func1(func2(func3()))